{"version":3,"names":["ldSidenavShadowCss","LdSidenav","this","toFocus","undefined","focusTimeout","updateFocus","clearTimeout","tabIndex","window","getComputedStyle","visibility","setTimeout","focus","toggleCollapsedState","collapsed","activeSubnavContainsIcons","slider","el","querySelector","activeSubnav","currentSubnav","navitemsModePrimaryChildren","Array","from","children","filter","child","tagName","mode","navitemsModePrimaryInAccordion","querySelectorAll","totalNavitemsModePrimary","length","isToggleOutside","element","onTransitionEnd","ev","target","transitions","fullyCollapsible","firstFocusableInSidenav","getFirstFocusable","previousElementSibling","focusInner","onMatchMediaChange","closable","matches","collapsible","ldSidenavBreakpointChange","emit","async","open","onCollapsedChange","ldSidenavCollapsedChange","fully","onOpenChange","ldSidenavOpenChange","updateFullyCollapsible","narrow","_a","updateCollapsible","handleClickOutside","isTrusted","includes","collapseTrigger","closest","handleMouseOut","relatedTarget","handleMouseIn","expandTrigger","handleOpen","handleClose","handleSlideBack","pop","currentSubnavId","id","parentSubnav","parentElement","navigateBack","shadowRoot","slideToHandler","ldSidenavBack","slideChangeHandler","updateLabel","_b","detail","label","hasActiveSubnav","handleKeyDown","hasSidenavFocus","document","activeElement","key","shiftKey","firstItemOfCurrentSubnav","isFocusInSidenav","trapFocus","isFocusInKeepFocusable","isLeavingSidenav","isLeavingFocusSelectorElement","trapFocusSelectorElements","firstFocusableFromSelectorElements","find","isLeavingFirstFocusableInSidenav","isLeavingFirstFocusableFromSelectorElements","lastFocusableInSidenav","reverse","lastFocusableFromSelectorElements","nextFocused","handleHeaderToggleClick","toggle","componentWillLoad","mediaQuery","matchMedia","breakpoint","addEventListener","componentDidLoad","disconnectedCallback","removeEventListener","render","cl","align","hasShadowTop","hasShadowBottom","toggleTransitionDisabled","h","Host","class","getClassNames","role","name","part","onClick","bind"],"sources":["./src/liquid/components/ld-sidenav/ld-sidenav.shadow.css?tag=ld-sidenav&encapsulation=shadow","./src/liquid/components/ld-sidenav/ld-sidenav.tsx"],"sourcesContent":[":host {\n  /* layout */\n  --ld-sidenav-line-height: 1.15;\n  --ld-sidenav-padding-x: 1rem;\n  --ld-sidenav-padding-y: 1rem;\n  --ld-sidenav-padding: var(--ld-sidenav-padding-y) var(--ld-sidenav-padding-x);\n  --ld-sidenav-toggle-size: var(--ld-sp-24);\n  --ld-sidenav-toggle-top: calc(\n    2 * var(--ld-sidenav-padding-y) + var(--ld-sidenav-navitem-icon-size) - 0.5 *\n      var(--ld-sidenav-toggle-size)\n  );\n  --ld-sidenav-translate-x-delta: calc(\n    var(--ld-sidenav-width) - var(--ld-sidenav-width-collapsed)\n  );\n  --ld-sidenav-width: 15.625rem;\n  --ld-sidenav-width-collapsed: calc(\n    2 * var(--ld-sidenav-padding-x) + var(--ld-sidenav-navitem-icon-size)\n  );\n  --ld-sidenav-width-fully-collapsed: calc(-1 * var(--ld-sp-1));\n\n  /* layout ld-navitem */\n  --ld-sidenav-navitem-active-indicator-border-width: 0.1875rem;\n  --ld-sidenav-navitem-icon-size: var(--ld-sp-32);\n  --ld-sidenav-navitem-bg-inset: var(--ld-sp-6);\n  --ld-sidenav-navitem-border-radius: var(--ld-br-l);\n  --ld-sidenav-navitem-tertiary-indent: calc(\n    3 * var(--ld-sidenav-padding-x) + 0.3125rem\n  );\n  --ld-sidenav-navitem-tertiary-width: calc(\n    100% - (4 * var(--ld-sidenav-padding-x)) - 0.3125rem\n  );\n\n  /* transitions */\n  --ld-sidenav-collapse-content-transition: opacity\n      var(--ld-sidenav-transition-duration-collapse-expand)\n      var(--ld-sidenav-transition-delay-collapse-expand) linear,\n    transform var(--ld-sidenav-transition-duration-collapse-expand) ease;\n  --ld-sidenav-transition-delay: 0s;\n  --ld-sidenav-transition-delay-collapse-expand: 0s;\n  /* Not using 0s here because we rely on the transition end event. */\n  --ld-sidenav-transition-duration: 0.001s;\n  --ld-sidenav-transition-duration-collapse-expand: 0.001s;\n  --ld-sidenav-translate-x-direction: 1;\n  --ld-sidenav-stack-to-top-transition: transform\n    var(--ld-sidenav-transition-duration-collapse-expand)\n    var(--ld-sidenav-transition-delay-collapse-expand) ease;\n\n  /* colors */\n  --ld-sidenav-bg-color: var(--ld-col-wht);\n  --ld-sidenav-separator-line-bg-col: var(--ld-col-neutral-100);\n  --ld-sidenav-subnav-bg-color: var(--ld-col-wht);\n\n  &(.ld-sidenav--transitions) {\n    @media (prefers-reduced-motion: no-preference) {\n      --ld-sidenav-transition-duration: 0.2s;\n      --ld-sidenav-transition-duration-collapse-expand: 0.2s;\n      --ld-sidenav-transition-delay: 0.1s;\n      --ld-sidenav-transition-delay-collapse-expand: 0.1s;\n    }\n  }\n\n  &(.ld-sidenav--toggle-transition-disabled) {\n    @media (prefers-reduced-motion: no-preference) {\n      --ld-sidenav-transition-duration-collapse-expand: 0.001s;\n      --ld-sidenav-transition-delay-collapse-expand: 0s;\n    }\n  }\n\n  background-color: var(--ld-sidenav-bg-color);\n  bottom: 0;\n  box-sizing: border-box;\n  display: flex;\n  flex-direction: column;\n  font: var(--ld-typo-body-m);\n  left: 0;\n  overflow: hidden;\n  position: var(--ld-sidenav-position, fixed);\n  text-align: left;\n  transition: transform var(--ld-sidenav-transition-duration-collapse-expand)\n    ease;\n  top: 0;\n  width: var(--ld-sidenav-width);\n  z-index: 0; /* create own stacking context */\n\n  &::before {\n    content: '';\n    position: absolute;\n    top: 0;\n    bottom: 0;\n    right: 0;\n    width: var(--ld-sp-2);\n    background-color: var(--ld-sidenav-separator-line-bg-col);\n    z-index: 2;\n  }\n\n  .ld-sidenav__content {\n    transition: opacity var(--ld-sidenav-transition-duration-collapse-expand)\n      linear;\n  }\n\n  &(.ld-sidenav--closable:not(.ld-sidenav--open)) {\n    .ld-sidenav__content {\n      transition: opacity var(--ld-sidenav-transition-duration-collapse-expand)\n          linear,\n        visibility 0s var(--ld-sidenav-transition-duration-collapse-expand)\n          linear;\n      visibility: hidden;\n    }\n  }\n\n  &(.ld-sidenav--collapsed:not(.ld-sidenav--closable)) {\n    transform: translateX(\n      calc(\n        var(--ld-sidenav-translate-x-direction) *\n          (-100% + var(--ld-sidenav-width-collapsed))\n      )\n    );\n  }\n\n  &(.ld-sidenav--collapsed.ld-sidenav--fully-collapsible:not(.ld-sidenav--closable)) {\n    transform: translateX(\n      calc(\n        var(--ld-sidenav-translate-x-direction) *\n          (-100% + var(--ld-sidenav-width-fully-collapsed))\n      )\n    );\n\n    .ld-sidenav__content {\n      opacity: 0;\n      visibility: hidden;\n    }\n  }\n\n  &(.ld-sidenav--collapsed.ld-sidenav--fully-collapsible.ld-sidenav--transitions:not(.ld-sidenav--closable)) {\n    .ld-sidenav__content {\n      transition: opacity var(--ld-sidenav-transition-duration-collapse-expand)\n          linear,\n        visibility 0s var(--ld-sidenav-transition-duration-collapse-expand)\n          linear;\n    }\n  }\n\n  &(.ld-sidenav--right) {\n    --ld-sidenav-translate-x-direction: -1;\n    --ld-sidenav-translate-x-delta: 0;\n    left: unset;\n    right: 0;\n\n    &::before {\n      right: unset;\n      left: 0;\n      transform: translateX(-50%) scaleX(1.5);\n    }\n  }\n\n  &(.ld-sidenav--closable) {\n    --ld-sidenav-collapse-content-transition: none;\n    --ld-sidenav-stack-to-top-transition: none;\n    --ld-sidenav-navitem-move-up-closable: 0;\n    --ld-sidenav-translate-x-delta: 0;\n    width: 100%;\n    transform: translateX(\n      calc(var(--ld-sidenav-translate-x-direction) * -100%)\n    );\n  }\n\n  &(.ld-sidenav--closable.ld-sidenav--open) {\n    transform: translateX(0);\n  }\n\n  ::slotted(ld-sidenav-navitem) {\n    margin-bottom: var(--ld-sidenav-padding-y);\n  }\n\n  ::slotted(ld-sidenav-navitem[slot='top']),\n  ::slotted(ld-sidenav-navitem[slot='bottom']) {\n    margin-top: var(--ld-sidenav-padding-y);\n  }\n\n  ::slotted(ld-sidenav-heading) {\n    margin: var(--ld-sidenav-padding-y) 0;\n  }\n}\n\n.ld-sidenav__toggle {\n  aspect-ratio: 1;\n  background-color: var(--ld-col-wht);\n  border: 0;\n  border-radius: var(--ld-br-full);\n  box-shadow: var(--ld-shadow-stacked);\n  color: var(--ld-thm-primary);\n  cursor: pointer;\n  display: grid;\n  outline-offset: var(--ld-sp-4);\n  place-content: center;\n  position: absolute;\n  right: 0;\n  top: var(--ld-sidenav-toggle-top);\n  touch-action: manipulation;\n  transform: translateX(50%);\n  width: var(--ld-sidenav-toggle-size);\n  will-change: transform; /* fixes rendering issue */\n  z-index: 1;\n  -webkit-touch-callout: none;\n\n  /* background color */\n  &::before {\n    content: '';\n    position: absolute;\n    inset: 0;\n    display: block;\n    border-radius: inherit;\n  }\n\n  /* increase click area */\n  &::after {\n    content: '';\n    position: absolute;\n    inset: calc(-1 * var(--ld-sp-6));\n    display: block;\n    border-radius: inherit;\n  }\n\n  &:hover,\n  &:focus:focus-visible {\n    &:not(:active) {\n      box-shadow: var(--ld-shadow-sticky);\n    }\n  }\n\n  &:where(:focus:focus-visible) {\n    color: var(--ld-thm-primary-hover);\n\n    &::before {\n      background-color: var(--ld-thm-primary-alpha-low);\n    }\n  }\n  @media (hover: hover) {\n    &:where(:hover) {\n      color: var(--ld-thm-primary-hover);\n    }\n  }\n  &:where(:active),\n  &:where(:active:focus-visible) {\n    color: var(--ld-thm-primary-active);\n  }\n\n  :host(.ld-sidenav--right) & {\n    transform: translateX(-50%);\n    right: unset;\n    left: 0;\n  }\n}\n\n.ld-sidenav__toggle-icon {\n  transform-origin: center;\n  position: relative;\n\n  :host(.ld-sidenav--collapsed) & {\n    transform: rotate(180deg);\n  }\n\n  :host(.ld-sidenav--right) & {\n    transform: rotate(180deg);\n  }\n  :host(.ld-sidenav--right.ld-sidenav--collapsed) & {\n    transform: none;\n  }\n}\n\n.ld-sidenav__content {\n  display: flex;\n  flex-direction: column;\n  height: 100%;\n  overflow: hidden;\n  will-change: transform; /* fixes overflow not working on slide transition */\n}\n\n.ld-sidenav__slot-container-default {\n  height: 100%;\n  position: relative;\n}\n\n.ld-sidenav__slot-container-top,\n.ld-sidenav__slot-container-bottom {\n  background-color: var(--ld-sidenav-bg-color);\n  z-index: 1;\n  position: relative;\n}\n\n.ld-sidenav__slot-container-top,\n.ld-sidenav__slot-container-default,\n.ld-sidenav__slot-container-bottom {\n  &::before {\n    visibility: visible;\n    z-index: 0;\n    opacity: 0;\n    content: '';\n    position: absolute;\n    inset: 0;\n    background-color: var(--ld-sidenav-subnav-bg-color);\n    transition: opacity var(--ld-sidenav-transition-duration-collapse-expand)\n      linear;\n  }\n\n  :host(.ld-sidenav--has-active-subnav) & {\n    &::before {\n      opacity: 1;\n    }\n  }\n}\n\n.ld-sidenav__fully-collapsed-click-area {\n  display: none;\n  inset: 0;\n  position: absolute;\n  z-index: 1;\n\n  :host(.ld-sidenav--collapsed.ld-sidenav--fully-collapsible:not(.ld-sidenav--closable))\n    & {\n    display: block;\n  }\n}\n","import {\n  Component,\n  Element,\n  Event,\n  EventEmitter,\n  h,\n  Host,\n  Listen,\n  Method,\n  Prop,\n  State,\n  Watch,\n} from '@stencil/core'\nimport { getClassNames } from '../../utils/getClassNames'\nimport { getFirstFocusable } from '../../utils/focus'\nimport { closest } from '../../utils/closest'\n\n/**\n * @slot - default slot, vertically scrollable.\n * @slot top - slot fixed at the top, above scrollable default slot.\n * @slot bottom - slot fixed at the bottom, below scrollable default slot.\n * @virtualProp ref - reference to component\n * @virtualProp {string | number} key - for tracking the node's identity when working with lists\n */\n@Component({\n  tag: 'ld-sidenav',\n  styleUrl: 'ld-sidenav.shadow.css',\n  shadow: true,\n})\nexport class LdSidenav {\n  @Element() el: HTMLLdSidenavElement\n  private mediaQuery: MediaQueryList\n\n  /** Whether the nav should be aligned to the left or the right side of its container. */\n  @Prop() align: 'left' | 'right' = 'left'\n\n  /**\n   * The breakpoint at which the sidenav takes full width and can be\n   * opened and closed as opposed to being expanded and collapsed.\n   * The prop value is used in a max-width media query.\n   */\n  @Prop() breakpoint = '23.4375rem'\n\n  /** Indicates that the navigation is collapsed to the side of its container. */\n  @Prop({ mutable: true }) collapsed = false\n\n  /**\n   * Makes the navigation collapse either on\n   * - explicit toggle button click,\n   * - when the user clicks somewhere outside the element or\n   * - when the user moves the cursor / focus outside the element.\n   * The modes are inclusive from right to left:\n   * - clickoutside applies if the collapse trigger is set to mouseout\n   * - toggle applies if the collapse trigger is set to clickoutside\n   */\n  @Prop() collapseTrigger: 'toggle' | 'clickoutside' | 'mouseout' = 'toggle'\n\n  /**\n   * Allows the side navigation to be collapsed to the side of its container.\n   */\n  @Prop() collapsible = false\n\n  /**\n   * Makes the navigation expand either on\n   * - explicit toggle button click,\n   * - when the user moves the cursor over the element.\n   * The modes are inclusive from right to left:\n   * - toggle applies if the expand trigger is set to mouseenter\n   */\n  @Prop() expandTrigger: 'toggle' | 'mouseenter' = 'toggle'\n\n  /** Label to be used for the landmark element (the sidenav itself). */\n  @Prop() label = 'Side navigation'\n\n  /**\n   * Set to true if you'd like to have a sidenav which partially\n   * collapses in way, that slotted ld-navitem components are displayed\n   * as icon buttons.\n   */\n  @Prop() narrow = false\n\n  /**\n   * Indicates that the navigation is visible in a viewport\n   * which is smaller than the value of the `breakpoint` prop.\n   */\n  @Prop({ mutable: true }) open = false\n\n  /**\n   * Disables transitions on collapsing and expansion of the sidenav.\n   * This is especially usefull when the page content gets pushed to\n   * the side on sidenav expansion, and you want to prevent too many\n   * layout shifts during the transition.\n   */\n  @Prop() toggleTransitionDisabled = false\n\n  /**\n   * Enables focus trapping. Accespts a CSS selector which indicates\n   * what is still focusable outside the sidenav, when the sidenav is\n   * closable and open (i.e. \"ld-header *\"). Use an empty string to\n   * enable focus trapping without specifying focusable elements\n   * outside the sidenav component.\n   */\n  @Prop() trapFocus?: string // The focus trap feature is\n  // disabled by default in order to not violate WCAG 2.1.2 (see\n  // https://www.w3.org/WAI/WCAG21/Understanding/no-keyboard-trap.html).\n  // It needs to be enabled explicitly, making sure that all visible\n  // UI elements are still focusable when the sidenav is opened.\n\n  @State() closable\n  @State() fullyCollapsible = false\n  @State() hasActiveSubnav = false\n  @State() hasShadowBottom = false\n  @State() hasShadowTop = false\n  @State() transitions = false\n\n  /**\n   * Toggles sidenav.\n   */\n  @Method()\n  async toggle() {\n    if (this.closable) {\n      this.open = !this.open\n    } else {\n      this.toggleCollapsedState()\n    }\n  }\n\n  /** Emitted when the sidenav collapses or expands. */\n  @Event() ldSidenavCollapsedChange: EventEmitter<{\n    collapsed: boolean\n    fully: boolean\n  }>\n\n  /** Emitted when the sidenav opens or closes. */\n  @Event() ldSidenavOpenChange: EventEmitter<boolean>\n\n  /** Emitted when the sidenav registers a match media change event. */\n  @Event() ldSidenavBreakpointChange: EventEmitter<boolean>\n\n  // The following event is not used within the ld-sidenav component itself.\n  // Its only purpose is to create a type definition on the ld-sidenav component,\n  // in order to be able to add an inline listener in TSX, for listening\n  // on the event bubling up from ld-sidenav-back components.\n  /** Emitted on click of the ld-sidenav-back component. */\n  @Event() ldSidenavBack: EventEmitter\n\n  // The following event is not used within the ld-sidenav component itself.\n  // Its only purpose is to create a type definition on the ld-sidenav component,\n  // in order to be able to add an inline listener in TSX, for listening\n  // on the event bubling up from ld-sidenav-navitem components.\n  /** Emitted on click of the ld-sidenav-navitem component if prop to is set. */\n  @Event() ldSidenavNavitemTo: EventEmitter<{ id: string; label: string }>\n\n  // The following event is not used within the ld-sidenav component itself.\n  // Its only purpose is to create a type definition on the ld-sidenav component,\n  // in order to be able to add an inline listener in TSX, for listening\n  // on the event bubling up from ld-sidenav-navitem components.\n  /** Emitted on click of the ld-sidenav-navitem component. */\n  @Event() ldSidenavNavitemClick: EventEmitter\n\n  // The following event is not used within the ld-sidenav component itself.\n  // Its only purpose is to create a type definition on the ld-sidenav component,\n  // in order to be able to add an inline listener in TSX, for listening\n  // on the event bubling up from ld-sidenav-slider components.\n  /** Emitted on navigation (before transition ends) of the ld-sidenav-slider component. */\n  @Event() ldSidenavSliderChange: EventEmitter<\n    { id: string; label: string } | undefined\n  >\n\n  @Watch('collapsed')\n  onCollapsedChange(collapsed) {\n    // The ldSidenavCollapsedChange event needs to be emitted even if the\n    // sidenav is currently not collapsible (when it is closable), because\n    // on breakpoint change its subcomponents need to be rendered according\n    // to the new state and thus need to update their state using the event.\n    this.ldSidenavCollapsedChange.emit({\n      collapsed,\n      fully: this.fullyCollapsible,\n    })\n\n    if (collapsed) {\n      this.open = false\n    }\n  }\n\n  @Watch('open')\n  onOpenChange(open) {\n    this.ldSidenavOpenChange.emit(open)\n\n    if (!open && this.collapsible) {\n      this.collapsed = true\n    }\n  }\n\n  @Watch('collapsible')\n  @Watch('narrow')\n  updateFullyCollapsible() {\n    this.fullyCollapsible =\n      this.collapsible && (!this.narrow || !this.activeSubnavContainsIcons())\n    if (!this.collapsible) this.collapsed = false\n    this.el.querySelector('ld-sidenav-header')?.updateCollapsible()\n  }\n\n  @Listen('click', {\n    target: 'window',\n  })\n  handleClickOutside(ev: MouseEvent) {\n    if (\n      ev.isTrusted &&\n      ['clickoutside', 'mouseout'].includes(this.collapseTrigger) &&\n      closest('ld-sidenav', ev.target as HTMLElement) !== this.el\n    ) {\n      this.collapsed = this.collapsible\n    }\n  }\n\n  @Listen('mouseout')\n  handleMouseOut(ev: MouseEvent) {\n    if (\n      this.collapseTrigger === 'mouseout' &&\n      ev.relatedTarget &&\n      (ev.relatedTarget as HTMLElement).closest('ld-sidenav') !== this.el\n    ) {\n      this.collapsed = this.collapsible\n    }\n  }\n\n  @Listen('mouseenter')\n  handleMouseIn() {\n    if (this.fullyCollapsible || this.expandTrigger === 'mouseenter') {\n      this.collapsed = false\n    }\n  }\n\n  @Listen('ldSidenavOpen')\n  handleOpen() {\n    this.open = true\n  }\n\n  @Listen('ldSidenavClose')\n  handleClose() {\n    clearTimeout(this.focusTimeout)\n    this.open = false\n  }\n\n  @Listen('ldSidenavBack')\n  handleSlideBack() {\n    clearTimeout(this.focusTimeout)\n    const currentSubnav = Array.from(\n      this.el.querySelectorAll('.ld-sidenav-subnav--active')\n    ).pop()\n    const currentSubnavId = currentSubnav?.id\n    const parentSubnav = currentSubnav?.parentElement\n    this.el.querySelector('ld-sidenav-slider').navigateBack()\n\n    // Set focus on parent nav-item element as soon as back button looses focus.\n    this.toFocus = parentSubnav\n      ?.querySelector<HTMLLdSidenavNavitemElement>(`[to='${currentSubnavId}']`)\n      .shadowRoot.querySelector<HTMLButtonElement | HTMLAnchorElement>(\n        '[part*=\"focusable\"]'\n      )\n\n    // Always expand side navigation on back button click.\n    this.collapsed = false\n  }\n\n  @Listen('ldSidenavNavitemTo')\n  slideToHandler() {\n    clearTimeout(this.focusTimeout)\n    // set focus on back button\n    const ldSidenavBack = this.el\n      .querySelector('ld-sidenav-back')\n      ?.shadowRoot.querySelector<HTMLElement>('.ld-sidenav-back')\n    this.toFocus = ldSidenavBack\n    this.updateFocus()\n  }\n\n  @Listen('ldSidenavSliderChange')\n  slideChangeHandler(\n    ev: CustomEvent<{ id: string; label: string } | undefined>\n  ) {\n    clearTimeout(this.focusTimeout)\n    this.el.querySelector('ld-sidenav-back')?.updateLabel(ev.detail?.label)\n\n    this.hasActiveSubnav = !!ev.detail\n\n    this.updateFullyCollapsible()\n    this.updateFocus()\n  }\n\n  @Listen('keydown', { passive: true, target: 'window' })\n  handleKeyDown(ev: KeyboardEvent) {\n    // Ignore events if sidenav has no focus and is not closable.\n    const hasSidenavFocus =\n      document.activeElement.closest('ld-sidenav') === this.el\n\n    if (\n      hasSidenavFocus &&\n      ev.key === 'Tab' &&\n      !ev.shiftKey &&\n      document.activeElement === this.el.querySelector('ld-sidenav-back')\n    ) {\n      // This block prevents the focus from being set to the wrong element,\n      // when a user quickly hits the [Tab] key after triggering the\n      // transition to a subnav.\n      const { currentSubnav } = this.el.querySelector('ld-sidenav-slider')\n\n      if (currentSubnav) {\n        const firstItemOfCurrentSubnav = getFirstFocusable(\n          this.el.querySelector<HTMLLdSidenavSubnavElement>(`#${currentSubnav}`)\n        )\n\n        setTimeout(async () => {\n          if ('focusInner' in firstItemOfCurrentSubnav) {\n            await (\n              firstItemOfCurrentSubnav as unknown as InnerFocusable\n            ).focusInner()\n          } else {\n            firstItemOfCurrentSubnav.focus()\n          }\n        })\n      }\n    }\n\n    if (!hasSidenavFocus && !this.closable) {\n      return\n    }\n\n    const slider = this.el.querySelector('ld-sidenav-slider')\n\n    if (ev.key === 'Escape') {\n      if (!slider && this.closable) {\n        this.open = false\n        return\n      }\n\n      if (this.hasActiveSubnav) {\n        this.handleSlideBack()\n      } else if (this.closable) {\n        this.open = false\n      }\n    }\n  }\n\n  @Listen('focusout', { passive: true, target: 'window' })\n  async handleFocusout(ev: FocusEvent) {\n    const relatedTarget = ev.relatedTarget as HTMLElement | undefined\n    const isFocusInSidenav = closest('ld-sidenav', relatedTarget) === this.el\n\n    // If focus is outside the sidenav and the collapse trigger is set\n    // to 'mouseout', collapse the sidenav.\n    if (!isFocusInSidenav && relatedTarget !== null) {\n      if (this.collapseTrigger === 'mouseout') {\n        this.collapsed = this.collapsible\n      }\n    }\n\n    // If focus is inside the sidenav expand the sidenav.\n    if (this.expandTrigger === 'mouseenter' && isFocusInSidenav) {\n      this.collapsed = false\n    }\n\n    // If the sidenav is closable, trap the focus.\n    // Do not trap the focus as long as the sidenav is not closable or not open.\n    if (!this.closable || !this.open) return\n\n    // Do not trap the focus if the trap focus prop is not set.\n    if (this.trapFocus === undefined) return\n\n    // Do not trap the focus as long as the focus remains within the sidenav.\n    if (isFocusInSidenav) return\n\n    // Do not trap the focus when it moves to an element which matches\n    // the trap focus selector or no element will be focused.\n    const isFocusInKeepFocusable =\n      this.trapFocus !== '' &&\n      (!relatedTarget || relatedTarget?.matches(this.trapFocus))\n    if (isFocusInKeepFocusable) return\n\n    // Loop the focus between the ld-sidenav and the elements matching\n    // the trap focus selector.\n    const target = ev.target as HTMLElement\n    const isLeavingSidenav = target.closest('ld-sidenav') === this.el\n    const isLeavingFocusSelectorElement =\n      this.trapFocus !== '' && !!target.closest(this.trapFocus)\n\n    if (!isLeavingSidenav && !isLeavingFocusSelectorElement) return\n\n    const firstFocusableInSidenav = getFirstFocusable(this.el)\n    const trapFocusSelectorElements =\n      this.trapFocus === ''\n        ? [firstFocusableInSidenav]\n        : Array.from(document.querySelectorAll<HTMLElement>(this.trapFocus))\n    const firstFocusableFromSelectorElements =\n      trapFocusSelectorElements.find(getFirstFocusable)\n    const isLeavingFirstFocusableInSidenav = firstFocusableInSidenav === target\n    const isLeavingFirstFocusableFromSelectorElements =\n      firstFocusableFromSelectorElements === target\n    const lastFocusableInSidenav = Array.from(\n      this.el.querySelectorAll<HTMLElement>('*')\n    )\n      .reverse()\n      .find(getFirstFocusable)\n    const lastFocusableFromSelectorElements = trapFocusSelectorElements\n      .reverse()\n      .find(getFirstFocusable)\n    const nextFocused = isLeavingSidenav\n      ? isLeavingFirstFocusableInSidenav\n        ? lastFocusableFromSelectorElements\n        : firstFocusableFromSelectorElements\n      : isLeavingFirstFocusableFromSelectorElements\n      ? lastFocusableInSidenav\n      : firstFocusableInSidenav\n\n    if (!nextFocused) return\n\n    if ('focusInner' in nextFocused) {\n      await (nextFocused as unknown as InnerFocusable).focusInner()\n    } else {\n      nextFocused?.focus()\n    }\n  }\n\n  @Listen('ldSidenavHeaderToggleClick')\n  handleHeaderToggleClick() {\n    this.toggle()\n  }\n\n  private toFocus: HTMLElement = undefined\n  private focusTimeout = undefined\n  private updateFocus = () => {\n    // HACK: Using recursive call with timeout to account for fast user interactions during transitions.\n    clearTimeout(this.focusTimeout)\n    if (this.toFocus) {\n      if (\n        this.toFocus.tabIndex === -1 ||\n        window.getComputedStyle(this.toFocus).visibility === 'hidden'\n      ) {\n        this.focusTimeout = setTimeout(this.updateFocus, 10)\n        return\n      }\n      this.toFocus.focus()\n      this.toFocus = undefined\n    }\n  }\n\n  private toggleCollapsedState = () => {\n    this.collapsed = !this.collapsed\n  }\n\n  private activeSubnavContainsIcons = () => {\n    const slider = this.el.querySelector('ld-sidenav-slider')\n    const activeSubnav = slider.currentSubnav\n      ? this.el.querySelector(`#${slider.currentSubnav}`)\n      : slider\n    const navitemsModePrimaryChildren = Array.from(\n      activeSubnav.children\n    ).filter(\n      (child) =>\n        child.tagName === 'LD-SIDENAV-NAVITEM' &&\n        !(child as HTMLLdSidenavNavitemElement).mode\n    )\n    const navitemsModePrimaryInAccordion = Array.from(\n      activeSubnav.querySelectorAll(\n        'ld-sidenav-accordion > ld-sidenav-navitem[slot=\"toggle\"]'\n      )\n    ).filter((child: HTMLLdSidenavNavitemElement) => !child.mode)\n    const totalNavitemsModePrimary =\n      navitemsModePrimaryChildren.length + navitemsModePrimaryInAccordion.length\n    return !!totalNavitemsModePrimary\n  }\n\n  private isToggleOutside = (\n    element?: Element\n  ): element is HTMLLdSidenavToggleOutsideElement =>\n    element?.tagName === 'LD-SIDENAV-TOGGLE-OUTSIDE'\n\n  private onTransitionEnd = (ev: TransitionEvent) => {\n    if (ev.target === this.el) {\n      this.transitions = true\n\n      // If the sidenav was fully collapsed and is being expanded, set the focus\n      // on the first focusable element. If it is being collapsed, set the focus\n      // on the toggle outside if it is there.\n      if (this.fullyCollapsible) {\n        if (!this.collapsed) {\n          const firstFocusableInSidenav = getFirstFocusable(this.el)\n          firstFocusableInSidenav.focus()\n        } else {\n          const previousElementSibling = this.el.previousElementSibling\n          if (this.isToggleOutside(previousElementSibling)) {\n            previousElementSibling.focusInner()\n          }\n        }\n      }\n    }\n  }\n\n  private onMatchMediaChange = (ev: MediaQueryListEvent) => {\n    this.closable = ev.matches\n\n    // Remove transitions class on breakpoint change in order to prevent\n    // weird looking transitions on screen resize or orientation change events.\n    // Add it back on transition end / after style changes have been applied.\n    this.transitions = false\n\n    // When there is less space available than before the breakpoint change,\n    // collapse the side nav if it is collapsible.\n    if (this.closable && this.collapsible) this.collapsed = true\n\n    this.ldSidenavBreakpointChange.emit(this.closable)\n  }\n\n  componentWillLoad() {\n    this.mediaQuery = window.matchMedia(`(max-width: ${this.breakpoint})`)\n    this.mediaQuery.addEventListener('change', this.onMatchMediaChange)\n    this.closable = this.mediaQuery.matches\n    this.updateFullyCollapsible()\n  }\n\n  componentDidLoad() {\n    this.ldSidenavCollapsedChange.emit({\n      collapsed: this.collapsible && this.collapsed,\n      fully: this.fullyCollapsible,\n    })\n    this.ldSidenavOpenChange.emit(this.open)\n    this.ldSidenavBreakpointChange.emit(this.closable)\n\n    setTimeout(() => {\n      this.transitions = true\n    })\n  }\n\n  disconnectedCallback() {\n    this.mediaQuery?.removeEventListener('change', this.onMatchMediaChange)\n  }\n\n  render() {\n    const cl = [\n      'ld-sidenav',\n      this.align === 'right' && 'ld-sidenav--right',\n      this.transitions && 'ld-sidenav--transitions',\n      this.closable && 'ld-sidenav--closable',\n      this.collapsible && this.collapsed && 'ld-sidenav--collapsed',\n      this.collapsible && 'ld-sidenav--collapsible',\n      this.fullyCollapsible && 'ld-sidenav--fully-collapsible',\n      this.hasActiveSubnav && 'ld-sidenav--has-active-subnav',\n      this.hasShadowTop && 'ld-sidenav--has-shadow-top',\n      this.hasShadowBottom && 'ld-sidenav--has-shadow-bottom',\n      this.open && 'ld-sidenav--open',\n      this.toggleTransitionDisabled && 'ld-sidenav--toggle-transition-disabled',\n    ]\n\n    return (\n      <Host\n        onTransitionEnd={this.onTransitionEnd}\n        class={getClassNames(cl)}\n        role=\"navigation\"\n        aria-label={this.label}\n      >\n        <slot name=\"header\"></slot>\n        <div class=\"ld-sidenav__content\">\n          <div class=\"ld-sidenav__slot-container-top\" part=\"slot-container-top\">\n            <slot name=\"top\"></slot>\n          </div>\n          <ld-sidenav-scroller-internal\n            class=\"ld-sidenav__scroller\"\n            part=\"scroll-container\"\n          >\n            <div\n              class=\"ld-sidenav__slot-container-default\"\n              part=\"slot-container\"\n            >\n              <slot></slot>\n            </div>\n          </ld-sidenav-scroller-internal>\n          <div\n            class=\"ld-sidenav__slot-container-bottom\"\n            part=\"slot-container-bottom\"\n          >\n            <slot name=\"bottom\"></slot>\n          </div>\n        </div>\n        <div\n          onClick={this.toggle.bind(this)}\n          class=\"ld-sidenav__fully-collapsed-click-area\"\n        ></div>\n      </Host>\n    )\n  }\n}\n"],"mappings":"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"}